# Pupil Data Preprocessing Methods

## Methods Paragraph (Dissertation Format)

Pupil diameter was continuously recorded using an MRI-compatible TRACKPixx binocular eye tracker (VPixx, Montreal, Canada) sampling at 2000 Hz. Raw eye-tracking data were exported as .mat files and processed through a multi-stage preprocessing pipeline designed to ensure high-quality pupillometry measurements. Blink artifacts and invalid samples were removed using the ET-remove-artifacts MATLAB toolbox (Huang et al., 2020), which employs a velocity-based detection algorithm that identifies blink onsets and offsets by detecting peaks and troughs in the filtered derivative of the pupil signal. The algorithm was configured with a 100th-order low-pass filter (passband: 10 Hz, stopband: 12 Hz) and peak/trough threshold factors of 5 standard deviations above baseline to detect blink events. Artifacts exceeding 2 seconds in duration were replaced with missing values rather than interpolated, following best practices for handling extended periods of signal loss. Following automated blink detection, all recordings underwent manual inspection and editing using the toolbox's interactive plot editor to identify and correct any remaining undetected artifacts and ensure proper interpolation across blink events. The manually cleaned pupil data were then trial-aligned using event timestamps extracted from the original recordings, synchronized with behavioral event markers, and downsampled from 2000 Hz to 250 Hz using an 8th-order anti-aliasing filter to preserve signal quality while reducing computational demands. This preprocessing pipeline resulted in artifact-corrected, trial-aligned pupil recordings integrated with behavioral metadata for subsequent statistical analyses.

